<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="G√ºnl√ºk T√ºrk√ße s√∂zler ‚Äì indir, payla≈ü, bo≈üver.">
  <title>S√∂zSanatƒ±</title>
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <meta name="theme-color" content="#6a11cb">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body {
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px;
    }
    .card {
      background: white;
      border-radius: 24px;
      padding: 25px;
      max-width: 800px;
      width: 100%;
      text-align: center;
      box-shadow: 0 12px 40px rgba(0,0,0,0.3);
    }
    .quote {
      font-size: 26px;
      line-height: 1.6;
      margin: 20px 0;
      color: #1a1a1a;
      font-weight: 600;
      hyphens: auto;
    }
    .author {
      font-style: italic;
      color: #555;
      font-size: 19px;
    }

    /* √áer√ßeve Se√ßici */
    .frame-selector {
      display: flex;
      justify-content: flex-start;
      gap: 12px;
      margin: 15px 0 10px;
      padding: 0 10px;
      overflow-x: auto;
      scrollbar-width: none;
    }
    .frame-selector::-webkit-scrollbar { display: none; }

    .frame-option {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 12px 14px;
      border: 2px solid #ddd;
      border-radius: 16px;
      background: white;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: #444;
      transition: all 0.2s ease;
      min-width: 85px;
      user-select: none;
      flex-shrink: 0;
    }
    .frame-option:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    }
    .frame-option.active {
      border-color: #6a11cb;
      background: #f0e6ff;
      color: #6a11cb;
      font-weight: 700;
    }
    .frame-option span {
      font-size: 22px;
      margin-bottom: 4px;
    }

    /* √ñnizleme */
    #preview {
      width: 100px;
      height: 100px;
      margin: 10px auto;
      border-radius: 12px;
      border: 2px solid #eee;
      transition: background 0.3s ease;
    }

    /* Format Se√ßici */
    .format-selector {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin: 15px 0;
      flex-wrap: wrap;
    }
    .format-btn {
      padding: 8px 14px;
      border: 1px solid #ccc;
      border-radius: 20px;
      background: white;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
    }
    .format-btn.active {
      background: #e3f2fd;
      border-color: #2196F3;
      color: #1976D2;
    }

    /* Butonlar */
    .buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin: 15px 0;
    }
    button {
      padding: 10px 16px;
      border: none;
      border-radius: 50px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.2s;
      font-weight: 600;
      white-space: nowrap;
    }
    #newBtn { background: #4CAF50; color: white; }
    #copyBtn { background: #2196F3; color: white; }
    #downloadBtn { background: #FF5722; color: white; }
    #twitterBtn { background: #1DA1F2; color: white; }
    #whatsappBtn { background: #25D366; color: white; }
    #installBtn {
      background: #FF9800;
      color: white;
      display: none;
      margin-top: 10px;
      width: 80%;
    }
    .status {
      margin-top: 12px;
      font-size: 14px;
      color: #555;
    }
    canvas { position: absolute; left: -9999px; }
  </style>
</head>
<body>
  <div class="card">
    <h2 style="margin-bottom:15px;">S√∂zSanatƒ±</h2>
    <p class="quote" id="quote">Y√ºkleniyor...</p>
    <p class="author" id="author">‚Äì Anonim</p>

    <!-- √áer√ßeve Se√ßici -->
    <div class="frame-selector" id="frameSelector">
      <div class="frame-option active" data-frame="minimal" title="Minimal">
        <span>üî≤</span> Minimal
      </div>
      <div class="frame-option" data-frame="gold" title="Altƒ±n">
        <span>üåü</span> Altƒ±n
      </div>
      <div class="frame-option" data-frame="twitter" title="ùïè Alƒ±ntƒ±sƒ±">
        <span>ùïè</span> Twitter
      </div>
      <div class="frame-option" data-frame="dramatic" title="Dramatik">
        <span>üñ§</span> Dramatik
      </div>
    </div>

    <!-- Mini √ñnizleme -->
    <div id="preview"></div>

    <!-- Format Se√ßici -->
    <div class="format-selector">
      <div class="format-btn active" data-format="square">Kare</div>
      <div class="format-btn" data-format="instagram">IG</div>
      <div class="format-btn" data-format="whatsapp">WA</div>
      <div class="format-btn" data-format="twitter">ùïè</div>
    </div>

    <!-- Butonlar -->
    <div class="buttons">
      <button id="newBtn">Yeni S√∂z</button>
      <button id="copyBtn">Kopyala</button>
      <button id="downloadBtn">ƒ∞ndir</button>
    </div>

    <div class="buttons">
      <button id="twitterBtn">ùïè'te Payla≈ü</button>
      <button id="whatsappBtn">WhatsApp</button>
    </div>

    <button id="installBtn">üì± Kur (PWA)</button>
    <p class="status" id="status"></p>
  </div>

  <canvas id="quoteCanvas"></canvas>

  <!-- S√∂zleri y√ºkle -->
  <script src="quotes.js"></script>
  <script>
    let currentQuote = null;
    let selectedFrame = 'minimal';
    let selectedFormat = 'square';
    let deferredPrompt = null;

    // PWA Kurulum Uyarƒ±sƒ±
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'block';
    });

    document.getElementById('installBtn').onclick = () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            document.getElementById('status').textContent = '‚úÖ Uygulama kuruldu!';
          }
          deferredPrompt = null;
          document.getElementById('installBtn').style.display = 'none';
        });
      }
    };

    // S√∂z g√∂ster
    function showRandomQuote() {
      const q = TURKISH_QUOTES[Math.floor(Math.random() * TURKISH_QUOTES.length)];
      document.getElementById('quote').textContent = q.q;
      document.getElementById('author').textContent = `‚Äì ${q.a}`;
      currentQuote = q;
    }

    // √áer√ßeve Se√ßimi
    document.querySelectorAll('.frame-option').forEach(option => {
      option.addEventListener('click', () => {
        document.querySelectorAll('.frame-option').forEach(el => el.classList.remove('active'));
        option.classList.add('active');
        selectedFrame = option.dataset.frame;
        updatePreview();
      });
    });

    // Format Se√ßimi
    document.querySelectorAll('.format-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.format-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        selectedFormat = btn.dataset.format;
      });
    });

    // √ñnizleme G√ºncelle
    function updatePreview() {
      const preview = document.getElementById('preview');
      const bgColors = {
        minimal: '#FFFFFF',
        gold: '#000000',
        twitter: '#15202B',
        dramatic: '#000000'
      };
      preview.style.backgroundColor = bgColors[selectedFrame];
    }
    updatePreview();

    // Kopyala
    document.getElementById('copyBtn').onclick = async () => {
      try {
        await navigator.clipboard.writeText(`${currentQuote.q}\n\n${currentQuote.a}`);
        document.getElementById('status').textContent = '‚úì Kopyalandƒ±!';
      } catch (err) {
        document.getElementById('status').textContent = '‚ùå Kopyalama ba≈üarƒ±sƒ±z.';
      }
      setTimeout(() => document.getElementById('status').textContent = '', 2000);
    };

    // Yeni S√∂z
    document.getElementById('newBtn').onclick = showRandomQuote;

    // Format boyutlarƒ±
    const FORMAT_SIZES = {
      square: { w: 800, h: 800, pad: 100 },
      instagram: { w: 1080, h: 1080, pad: 120 },
      whatsapp: { w: 1080, h: 1920, pad: 150 },
      twitter: { w: 1200, h: 675, pad: 100 }
    };

    // Stil renkleri
    const STYLE_COLORS = {
      minimal: { bg: '#FFFFFF', text: '#111', author: '#555' },
      gold: { bg: '#000000', text: '#FFD700', author: '#FFD700' },
      twitter: { bg: '#15202B', text: '#FFFFFF', author: '#1DA1F2' },
      dramatic: { bg: '#000000', text: '#FFD700', author: '#FFD700' }
    };

    // Metni satƒ±r satƒ±r b√∂l
    function wrapText(ctx, text, maxWidth) {
      const words = text.split(' ');
      const lines = [];
      let line = words[0] || '';
      for (let i = 1; i < words.length; i++) {
        const test = line + ' ' + words[i];
        if (ctx.measureText(test).width < maxWidth) {
          line = test;
        } else {
          lines.push(line);
          line = words[i];
        }
      }
      lines.push(line);
      return lines;
    }

    // ƒ∞ndir
    document.getElementById('downloadBtn').onclick = () => {
      const fmt = FORMAT_SIZES[selectedFormat];
      const style = STYLE_COLORS[selectedFrame];
      const canvas = document.getElementById('quoteCanvas');
      const ctx = canvas.getContext('2d');

      canvas.width = fmt.w;
      canvas.height = fmt.h;

      ctx.fillStyle = style.bg;
      ctx.fillRect(0, 0, fmt.w, fmt.h);

      const maxFontSize = Math.min(72, Math.floor(fmt.w / 15));
      ctx.font = `bold ${maxFontSize}px Poppins`;
      ctx.fillStyle = style.text;
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';

      const lines = wrapText(ctx, currentQuote.q, fmt.w - fmt.pad * 2);
      const lineHeight = maxFontSize * 1.3;
      const totalHeight = lines.length * lineHeight + 80;
      let y = (fmt.h - totalHeight) / 2;

      lines.forEach((line, i) => {
        ctx.fillText(line, fmt.w / 2, y + i * lineHeight);
      });

      ctx.fillStyle = style.author;
      ctx.font = `normal ${Math.floor(maxFontSize * 0.6)}px Poppins`;
      ctx.fillText(`‚Äì ${currentQuote.a}`, fmt.w / 2, y + lines.length * lineHeight + 60);

      const link = document.createElement('a');
      link.download = `sozsanati-${selectedFrame}-${selectedFormat}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
    };

    // Payla≈üƒ±m
    document.getElementById('twitterBtn').onclick = () => {
      const txt = `"${currentQuote.q}" ‚Äî ${currentQuote.a}`;
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(txt)}`, '_blank');
    };
    document.getElementById('whatsappBtn').onclick = () => {
      const txt = `"${currentQuote.q}"\n‚Äî ${currentQuote.a}`;
      window.open(`https://wa.me/?text=${encodeURIComponent(txt)}`, '_blank');
    };

    // Ba≈ülat
    showRandomQuote();
  </script>
</body>
</html>
