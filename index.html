<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="description" content="G√ºnl√ºk T√ºrk√ße s√∂zler ‚Äì indir, payla≈ü, bo≈üver.">
  <title>S√∂zSanatƒ±</title>
  <link rel="manifest" href="manifest.json">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
  <meta name="theme-color" content="#6a11cb">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    body {
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 15px;
    }
    .card {
      background: white;
      border-radius: 24px;
      padding: 30px;
      max-width: 800px;
      width: 100%;
      text-align: center;
      box-shadow: 0 12px 40px rgba(0,0,0,0.3);
    }
    .quote {
      font-size: 26px;
      line-height: 1.6;
      margin: 20px 0;
      color: #1a1a1a;
      font-weight: 600;
    }
    .author {
      font-style: italic;
      color: #555;
      font-size: 19px;
    }
    .buttons {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin: 15px 0;
    }
    button {
      padding: 10px 16px;
      border: none;
      border-radius: 50px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.2s;
      font-weight: 600;
      white-space: nowrap;
    }
    #newBtn { background: #4CAF50; color: white; }
    #copyBtn { background: #2196F3; color: white; }
    #downloadBtn { background: #FF5722; color: white; }
    #twitterBtn { background: #1DA1F2; color: white; }
    #whatsappBtn { background: #25D366; color: white; }
    #installBtn {
      background: #FF9800;
      color: white;
      display: none;
      margin-top: 10px;
    }
    #frameSelect {
      padding: 10px;
      border-radius: 12px;
      border: 2px solid #ddd;
      font-size: 14px;
      margin: 10px auto;
      max-width: 250px;
    }
    canvas { position: absolute; left: -9999px; }
    .status {
      margin-top: 12px;
      font-size: 14px;
      color: #555;
    }
  </style>
</head>
<body>
  <div class="card">
    <h2>S√∂zSanatƒ±</h2>
    <p class="quote" id="quote">Y√ºkleniyor...</p>
    <p class="author" id="author">‚Äì Anonim</p>

    <select id="frameSelect">
      <option value="minimal">Minimal</option>
      <option value="gold">Altƒ±n √áer√ßeve</option>
      <option value="twitter">ùïè Alƒ±ntƒ±sƒ±</option>
      <option value="dramatic">Dramatik Siyah</option>
    </select>

    <div class="buttons">
      <button id="newBtn">Yeni S√∂z</button>
      <button id="copyBtn">Kopyala</button>
      <button id="downloadBtn">ƒ∞ndir</button>
    </div>

    <div class="buttons">
      <button id="twitterBtn">ùïè'te Payla≈ü</button>
      <button id="whatsappBtn">WhatsApp</button>
    </div>

    <button id="installBtn">üì± Kur (PWA)</button>
    <p class="status" id="status"></p>
  </div>

  <canvas id="quoteCanvas"></canvas>

  <!-- S√∂zleri y√ºkle -->
  <script src="quotes.js"></script>
  <script>
    let currentQuote = null;
    let deferredPrompt = null;

    // PWA install prompt
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      document.getElementById('installBtn').style.display = 'block';
    });

    document.getElementById('installBtn').onclick = () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choiceResult) => {
          if (choiceResult.outcome === 'accepted') {
            document.getElementById('status').textContent = '‚úÖ Uygulama kuruldu!';
          }
          deferredPrompt = null;
          document.getElementById('installBtn').style.display = 'none';
        });
      }
    };

    // S√∂z g√∂ster
    function showRandomQuote() {
      const q = TURKISH_QUOTES[Math.floor(Math.random() * TURKISH_QUOTES.length)];
      document.getElementById('quote').textContent = q.q;
      document.getElementById('author').textContent = `‚Äì ${q.a}`;
      currentQuote = q;
    }

    // Kopyala
    document.getElementById('copyBtn').onclick = async () => {
      try {
        await navigator.clipboard.writeText(`${currentQuote.q}\n\n${currentQuote.a}`);
        document.getElementById('status').textContent = '‚úì Kopyalandƒ±!';
      } catch (err) {
        document.getElementById('status').textContent = '‚ùå Kopyalama ba≈üarƒ±sƒ±z.';
      }
      setTimeout(() => document.getElementById('status').textContent = '', 2000);
    };

    // Yeni s√∂z
    document.getElementById('newBtn').onclick = showRandomQuote;

    // ƒ∞ndir (Canvas ile)
    document.getElementById('downloadBtn').onclick = () => {
      const frame = document.getElementById('frameSelect').value;
      downloadAsImage(frame);
    };

    // G√∂rsel indirme fonksiyonu
    function downloadAsImage(frameType) {
      const canvas = document.getElementById('quoteCanvas');
      const ctx = canvas.getContext('2d');
      const w = 800, h = 800;
      canvas.width = w;
      canvas.height = h;

      // Stil ayarlarƒ±
      let bgColor, textColor, authorColor;
      if (frameType === 'gold' || frameType === 'dramatic') {
        bgColor = '#000';
        textColor = '#FFD700';
        authorColor = '#FFD700';
      } else if (frameType === 'twitter') {
        bgColor = '#15202B';
        textColor = '#FFFFFF';
        authorColor = '#1DA1F2';
      } else {
        bgColor = '#FFFFFF';
        textColor = '#111';
        authorColor = '#555';
      }

      ctx.fillStyle = bgColor;
      ctx.fillRect(0, 0, w, h);

      // Yazƒ±
      ctx.fillStyle = textColor;
      ctx.font = 'bold 48px Poppins';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';

      const quote = currentQuote.q;
      const author = `‚Äì ${currentQuote.a}`;
      const maxWidth = w - 120;

      // Satƒ±r b√∂lme
      function wrapText(text, maxWidth) {
        const words = text.split(' ');
        let line = '';
        const lines = [];
        for (let i = 0; i < words.length; i++) {
          const testLine = line + words[i] + ' ';
          if (ctx.measureText(testLine).width > maxWidth) {
            lines.push(line.trim());
            line = words[i] + ' ';
          } else {
            line = testLine;
          }
        }
        lines.push(line.trim());
        return lines;
      }

      const lines = wrapText(quote, maxWidth);
      const yStart = (h - (lines.length * 60 + 80)) / 2;

      lines.forEach((line, i) => {
        ctx.fillText(line, w / 2, yStart + i * 60);
      });

      ctx.fillStyle = authorColor;
      ctx.font = '32px Poppins';
      ctx.fillText(author, w / 2, yStart + lines.length * 60 + 60);

      // ƒ∞ndir
      const link = document.createElement('a');
      link.download = `sozsanati-${frameType}.png`;
      link.href = canvas.toDataURL('image/png');
      link.click();
    }

    // Payla≈üƒ±m
    document.getElementById('twitterBtn').onclick = () => {
      const txt = `"${currentQuote.q}" ‚Äî ${currentQuote.a}`;
      window.open(`https://twitter.com/intent/tweet?text=${encodeURIComponent(txt)}`, '_blank');
    };
    document.getElementById('whatsappBtn').onclick = () => {
      const txt = `"${currentQuote.q}"\n‚Äî ${currentQuote.a}`;
      window.open(`https://wa.me/?text=${encodeURIComponent(txt)}`, '_blank');
    };

    // Ba≈ülat
    showRandomQuote();
  </script>
</body>
</html>
